<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Register - EXAM-HA</title>
  <link rel="stylesheet" href="style2.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>

<div class="form-wrapper">
  <h2 class="title">Registration Form</h2>

  <form id="signupForm" class="step-form">
    <div class="step active-step">
      <label>First Name :</label>
      <input type="text" name="firstname" required />

      <label>Last Name :</label>
      <input type="text" name="lastname" required />

      <button type="button" class="next">Next</button>
    </div>

    <div class="step">
      <label>Email Address :</label>
      <input type="email" name="email" required />

      <label>Date of Birth :</label>
      <input type="date" name="dob" required />

      <button type="button" class="next">Next</button>
    </div>

    <div class="step">
      <label>Gender :</label>
      <select name="gender" required>
        <option value="">Select</option>
        <option value="male">Male</option>
        <option value="female">Female</option>
      </select>

      <label>Institution :</label>
      <input type="text" name="institution" required />

      <button type="button" class="next">Next</button>
    </div>

    <div class="step">
      <label>Major (Department) :</label>
      <input type="text" name="department" required />

      <label>User Type :</label>
      <select name="role" required>
        <option value="">Select</option>
        <option value="student">Student</option>
        <option value="teacher">Teacher</option>
      </select>

      <label>Password :</label>
      <input type="password" name="password" required />

      <button type="submit">Register</button>
    </div>

    <!-- رسالة النجاح أو الخطأ -->
    <div id="message" style="margin-top: 10px; color: green;"></div>

  </form>
</div>

<script>
  const steps = document.querySelectorAll('.step');
  const nextButtons = document.querySelectorAll('.next');
  let currentStep = 0;

  nextButtons.forEach((btn, index) => {
    btn.addEventListener('click', () => {
      steps[currentStep].classList.remove('active-step');
      currentStep++;
      steps[currentStep].classList.add('active-step');
    });
  });

  const signupForm = document.getElementById('signupForm');

  if (signupForm) {
    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const userData = {
        firstname: signupForm.firstname.value,
        lastname: signupForm.lastname.value,
        email: signupForm.email.value,
        dob: signupForm.dob.value,
        gender: signupForm.gender.value,
        institution: signupForm.institution.value,
        department: signupForm.department.value,
        role: signupForm.role.value,
        password: signupForm.password.value
      };
      console.log('Password before sending:', signupForm.password.value);

      try {
        const res = await fetch('http://localhost:5000/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(userData)
        });

        const data = await res.text();


        if (res.ok) {
          document.getElementById('message').innerText = "✅ " + data;

        } else {
          document.getElementById('message').innerText = "❌ " + data;
        }
      } catch (error) {
        document.getElementById('message').innerText = "❌ Error while signing up.";
        console.error(error);
      }
    });
  }
</script>

</body>
</html>